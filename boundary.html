<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Homestead Municipality Address Check</title>

  <link href="https://fonts.googleapis.com/css?family=Lato:400,700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Lato', sans-serif;
      margin: 0; padding: 0;
      display: flex; flex-direction: column; align-items: center;
      background-color: #f4f4f9;
    }
    .header-wrapper {
      display: flex; justify-content: space-between; align-items: center;
      width: 90%; max-width: 400px; margin: 10px auto; padding: 10px 0;
    }
    #hamburgerMenu { background: none; border: none; font-size: 24px; cursor: pointer; color: black; }
    #menuDropdown {
      display: none; position: absolute; background: #f9f9f9; border-radius: 10px; padding: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,.2); min-width: 230px; top: 60px; right: 5%; z-index: 1000;
    }
    #menuDropdown ul { list-style: none; margin: 0; padding: 0; }
    #menuDropdown li { border-bottom: 1px solid black; }
    #menuDropdown li a { display: block; padding: 12px; color: black; text-decoration: none; border-radius: 5px; }
    #menuDropdown li a:hover { background: #ddd; }

    @media (max-width: 600px) {
      .header-wrapper { width: 95%; padding: 5px 0; }
      #hamburgerMenu { font-size: 20px; }
      #menuDropdown { right: 5%; }
    }

    h1 {
      font-size: 14px; font-weight: bold; text-align: left;
      width: 90%; max-width: 400px; margin: 10px auto;
    }
    .input-container {
      width: 90%; max-width: 400px; margin: 10px auto;
      display: flex; flex-direction: column; align-items: center;
    }
    .input-container label {
      font-size: 14px; font-weight: bold; margin-bottom: 5px; text-align: left; width: 100%;
    }
    .input-container input {
      width: 100%; padding: 10px; margin-bottom: 10px; font-size: 14px;
      border: 1px solid #ccc; border-radius: 5px;
    }
    .input-container input:focus { outline: none; border: 1px solid #0073e6; }
    .input-container input.error { border-color: #d93025; }

    .map-container { width: 90%; max-width: 400px; height: 400px; margin: 20px auto; }
    #result {
      margin-top: 10px; font-size: 14px; font-weight: bold; text-align: left;
      line-height: 1.6; padding: 10px; width: 90%; max-width: 400px; display: none;
      border-radius: 8px; margin: 20px auto; background: #ecfdf5; color: #065f46;
    }
    #result.outside { background: #fef2f2; color: #991b1b; }

    .button-container { width: 90%; max-width: 400px; margin: 20px auto; text-align: center; }
    .button-container button {
      width: 100%; padding: 10px 20px; font-size: 14px; background-color: blue; color: white;
      border: none; border-radius: 5px; cursor: pointer; text-align: center;
    }
    .button-container button.green { background-color: #28a745; }

    .popup {
      display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
      background: white; padding: 20px; border: 1px solid #ccc; border-radius: 10px; text-align: left;
      width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto;
      box-shadow: 0 4px 6px rgba(0,0,0,.1); z-index: 1000;
    }
    input[type="checkbox"]#consent {
      opacity: 1 !important; display: inline-block !important; width: 20px !important; height: 20px !important;
      background-color: #fff !important; border: 2px solid #007bff !important; cursor: pointer !important;
      visibility: visible !important; z-index: 1000 !important;
    }

    @media (max-width: 600px) {
      .input-container, .button-container, .map-container, #result { width: 95%; }
    }
  </style>

  <!-- Google Translate -->
  <script>
    function googleTranslateElementInit() {
      new google.translate.TranslateElement(
        { pageLanguage: 'en', includedLanguages: 'es,ht', layout: google.translate.TranslateElement.InlineLayout.SIMPLE },
        'google_translate_element'
      );
    }
  </script>
  <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

  <!-- Turf.js -->
  <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
</head>
<body>

  <div class="header-wrapper">
    <div id="google_translate_element"></div>
    <button id="hamburgerMenu">‚ò∞</button>
  </div>

  <div id="menuDropdown">
    <ul>
      <li><a href="https://registertovoteflorida.gov/home" target="_blank">‚úî Check Voter Status</a></li>
      <li><a href="https://www.vote.org/register-to-vote/" target="_blank">üìù Register to Vote</a></li>
      <li><a href="https://www.miamidade.gov/global/elections/vote-by-mail.page" target="_blank">üì© Request Your Vote-by-Mail Ballot</a></li>
      <li><a href="https://lkt.337.myftpupload.com/login" target="_blank">üîë Login</a></li>
    </ul>
  </div>

  <h1>Check if Your Address is Within the Municipality of Homestead</h1>

  <div class="input-container">
    <label for="addressInput">Enter your address:</label>
    <input type="text" id="addressInput" placeholder="Enter address here">
  </div>

  <div id="result"></div>

  <div id="map-container" class="map-container"></div>

  <div class="input-container">
    <label for="nameInput">Enter your name:</label>
    <input type="text" id="nameInput" placeholder="Your Name">
  </div>
  <div class="input-container">
    <label for="voterCountInput">How many voters at this address?</label>
    <input type="number" id="voterCountInput" placeholder="Number of Voters" min="1">
  </div>
  <div class="input-container">
    <label for="phoneNumberInput">Enter your phone number:</label>
    <input type="tel" id="phoneNumberInput" placeholder="(123) 456-7890">
  </div>
  <div class="input-container">
    <label for="referralInput">Name of person who referred you:</label>
    <input type="text" id="referralInput" placeholder="Name of person who referred you">
  </div>

  <div class="button-container">
    <button class="green" onclick="validateAndSubmit()">Submit</button>
  </div>

  <!-- Popup -->
  <div id="thankYouPopup" class="popup">
    <h2>Thank You for Your Support!</h2>
    <p>Your commitment makes a difference! By pledging your support, you're standing with Julio Guzman and helping shape the future of Homestead.</p>
    <h3>Make Your Voice Count! Pledge Your Support Today</h3>
    <p>Check the box below and sign to officially pledge your support for Julio Guzman‚Äôs campaign.</p>
    <div class="preference">
      <label for="consent">
        <input type="checkbox" name="consent" id="consent">
        I consent to having my name included in campaign materials
      </label>
    </div>
    <label for="signatureInput">Your Signature:</label>
    <input type="text" id="signatureInput" name="signature" placeholder="Type your full name here">
    <div class="button-container">
      <button id="submitButton" class="green" onclick="handleConfirmation()">Submit</button>
    </div>
  </div>

  <script>
    // ===== Menu toggle =====
    document.addEventListener("DOMContentLoaded", () => {
      const hamburgerMenu = document.getElementById("hamburgerMenu");
      const menuDropdown = document.getElementById("menuDropdown");
      hamburgerMenu.addEventListener("click", (e) => {
        e.stopPropagation();
        menuDropdown.style.display = menuDropdown.style.display === "block" ? "none" : "block";
      });
      document.addEventListener("click", (e) => {
        if (!menuDropdown.contains(e.target) && !hamburgerMenu.contains(e.target)) {
          menuDropdown.style.display = "none";
        }
      });
    });

    // ===== Phone formatter =====
    const phoneNumberInput = document.getElementById("phoneNumberInput");
    phoneNumberInput.addEventListener("input", (event) => {
      const input = event.target;
      let v = input.value.replace(/\D/g, "").slice(0, 10);
      if (v.length > 6) v = `(${v.slice(0,3)}) ${v.slice(3,6)}-${v.slice(6)}`;
      else if (v.length > 3) v = `(${v.slice(0,3)}) ${v.slice(3)}`;
      input.value = v;
    });

    // ===== Homestead boundary (GeoJSON) =====
    const homesteadBoundary = {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [[
          [-80.4120765, 25.4814287], [-80.4121837, 25.4850587], [-80.4122839, 25.4923133], [-80.4123524, 25.4996034],
          [-80.4142083, 25.4995867], [-80.414213, 25.5144809], [-80.4216834, 25.5144577], [-80.4217181, 25.4995736],
          [-80.429074, 25.4995493], [-80.4291071, 25.4812239], [-80.4327771, 25.4811986], [-80.432824, 25.4628292],
          [-80.440205, 25.4627962], [-80.440217, 25.471957], [-80.440237, 25.481156], [-80.44025, 25.488349],
          [-80.44027, 25.499516], [-80.440277, 25.503975], [-80.44028, 25.507025], [-80.440286, 25.510692],
          [-80.44029, 25.51443], [-80.44766, 25.514407], [-80.44767, 25.51079], [-80.44768, 25.50372],
          [-80.44769, 25.4995], [-80.4477, 25.49525], [-80.44771, 25.49004], [-80.44772, 25.48112],
          [-80.44773, 25.47466], [-80.44775, 25.46276], [-80.45508, 25.46272], [-80.45512, 25.48107],
          [-80.45513, 25.48625], [-80.45515, 25.49946], [-80.45516, 25.50312], [-80.45518, 25.51436],
          [-80.4625, 25.51433], [-80.46255, 25.49944], [-80.46257, 25.49185], [-80.46259, 25.48103],
          [-80.46262, 25.46267], [-80.47728, 25.46261], [-80.4773, 25.47177], [-80.47734, 25.49089],
          [-80.47735, 25.4994], [-80.47738, 25.51427], [-80.4847, 25.51424], [-80.48472, 25.50682],
          [-80.48474, 25.49938], [-80.48477, 25.48814], [-80.4848, 25.47173], [-80.48482, 25.46258],
          [-80.4921, 25.46255], [-80.49215, 25.48098], [-80.49217, 25.49079], [-80.49218, 25.49935],
          [-80.4922, 25.50806], [-80.49222, 25.51421], [-80.4995, 25.51418], [-80.4995, 25.48095],
          [-80.4995, 25.46251], [-80.5069, 25.46248], [-80.5069, 25.48092], [-80.5069, 25.4993],
          [-80.5069, 25.51415], [-80.5143, 25.51411], [-80.5143, 25.49927], [-80.5143, 25.48088],
          [-80.5143, 25.46244], [-80.5217, 25.46241], [-80.5217, 25.51408], [-80.5143, 25.51411],
          [-80.5143, 25.46244], [-80.5069, 25.46248], [-80.4995, 25.46251], [-80.4921, 25.46255],
          [-80.48482, 25.46258], [-80.47728, 25.46261], [-80.46262, 25.46267], [-80.45508, 25.46272],
          [-80.44775, 25.46276], [-80.440217, 25.471957], [-80.440205, 25.4627962], [-80.432824, 25.4628292],
          [-80.4287995, 25.462851], [-80.428807, 25.459325], [-80.42881, 25.457198], [-80.428815, 25.453671],
          [-80.42882, 25.451475], [-80.428827, 25.447948], [-80.42883, 25.445582], [-80.42884, 25.442054],
          [-80.42884, 25.440315], [-80.42884, 25.438255], [-80.42152, 25.43829], [-80.42151, 25.44208],
          [-80.4215, 25.44561], [-80.42149, 25.44965], [-80.42148, 25.4537], [-80.42147, 25.45722],
          [-80.42146, 25.46288], [-80.41408, 25.46292], [-80.4037996, 25.4629855], [-80.403927, 25.4778905],
          [-80.4048218, 25.4778824], [-80.4048645, 25.4803748], [-80.4119385, 25.4803037], [-80.4120554, 25.4802975],
          [-80.4120765, 25.4814287]
        ]]
      }
    };

    let map, autocomplete, marker, boundaryPolygon, homesteadBounds;

    // ===== Google Maps init (global; callback must find this) =====
    function initMap() {
      const mapCenter = { lat: 25.4687, lng: -80.4776 };
      map = new google.maps.Map(document.getElementById("map-container"), {
        center: mapCenter, zoom: 13,
        mapTypeControl: false, streetViewControl: false
      });

      // Build polygon paths
      const coords = homesteadBoundary.geometry.coordinates[0].map(([lng, lat]) => ({ lat, lng }));

      // Draw polygon (reuse a single overlay)
      boundaryPolygon = new google.maps.Polygon({
        paths: coords,
        strokeColor: "#ef4444", strokeOpacity: 1, strokeWeight: 2,
        fillColor: "#ef4444", fillOpacity: 0.18
      });
      boundaryPolygon.setMap(map);

      // Fit to bounds and keep for Autocomplete bias
      homesteadBounds = new google.maps.LatLngBounds();
      coords.forEach(c => homesteadBounds.extend(c));
      map.fitBounds(homesteadBounds);

      // Autocomplete setup (type-ahead)
      const input = document.getElementById("addressInput");
      autocomplete = new google.maps.places.Autocomplete(input, { types: ["address"], componentRestrictions: { country: "us" } });
      autocomplete.setBounds(homesteadBounds); // bias suggestions to Homestead

      autocomplete.addListener("place_changed", () => {
        const place = autocomplete.getPlace();
        if (!place.geometry) {
          showResult(false, "No details available for that address.");
          return;
        }
        displayResults(place.geometry.location);
      });
    }

    // ===== Check & display =====
    function displayResults(latLng) {
      const point = turf.point([latLng.lng(), latLng.lat()]);
      const polygon = turf.polygon(homesteadBoundary.geometry.coordinates);
      const isInside = turf.booleanPointInPolygon(point, polygon, { ignoreBoundary: false });

      // Reuse a single marker
      if (!marker) {
        marker = new google.maps.Marker({ position: latLng, map, title: "Location Checked" });
      } else {
        marker.setPosition(latLng);
      }
      map.setCenter(latLng);
      map.setZoom(15);

      showResult(isInside);
    }

    function showResult(isInside, override) {
      const el = document.getElementById("result");
      el.style.display = "block";
      el.classList.remove("outside");
      if (override) { el.textContent = override; return; }

      if (isInside) {
        el.innerHTML = `
          <ul style="list-style: disc; padding-left: 18px; margin: 0;">
            <li><strong style="color: #15803d;">‚úî Yes! Your address is in the Municipality of Homestead.</strong></li>
            <li>üìå Please answer the questions below the map.</li>
          </ul>`;
      } else {
        el.classList.add("outside");
        el.innerHTML = `
          <ul style="list-style: disc; padding-left: 18px; margin: 0;">
            <li><strong style="color: #b91c1c;">‚ùå No, the address is not within the Municipality of Homestead.</strong></li>
            <li>Think of 2 people you know in Homestead and share this campaign with them.</li>
            <li>üì¢ <a href="https://yourcampaignlink.com" target="_blank" rel="noopener">Spread the word!</a></li>
          </ul>`;
      }
    }

    // ===== Popup & localStorage =====
    function openPopup(){ document.getElementById("thankYouPopup").style.display = "block"; }
    function closePopup(){ document.getElementById("thankYouPopup").style.display = "none"; }

    function submitVoterData() {
      const userName = document.getElementById("nameInput").value.trim();
      const voterCount = document.getElementById("voterCountInput").value.trim();
      const consent = document.getElementById("consent").checked;

      if (!userName || !voterCount || Number(voterCount) <= 0) {
        alert("Please enter your name and the number of voters at this address.");
        return false;
      }
      const today = new Date().toISOString().split("T")[0];
      const store = JSON.parse(localStorage.getItem("voterData") || "{}");
      store[today] = store[today] || [];
      store[today].push({ name: userName, count: Number(voterCount), pledged: consent });
      localStorage.setItem("voterData", JSON.stringify(store));
      return true;
    }

    function handleConfirmation() {
      if (!submitVoterData()) return;
      alert("Thank you for pledging your commitment. Remember to request/renew your vote-by-mail ballot on the top right corner of the home page.");
      closePopup();
    }

    function validateAndSubmit() {
      const nameInput = document.getElementById("nameInput");
      const voterCountInput = document.getElementById("voterCountInput");
      const phoneInput = document.getElementById("phoneNumberInput");

      let ok = true;
      [nameInput, voterCountInput, phoneInput].forEach(el => el.classList.remove("error"));

      if (!nameInput.value.trim()) { nameInput.classList.add("error"); ok = false; }
      const count = parseInt(voterCountInput.value, 10);
      if (isNaN(count) || count <= 0) { voterCountInput.classList.add("error"); ok = false; }

      const digits = phoneInput.value.replace(/\D/g, "");
      if (phoneInput.value.trim() && digits.length !== 10) {
        phoneInput.classList.add("error");
        alert("Please enter a valid 10-digit phone number or leave it blank.");
        ok = false;
      }
      if (!ok) return;

      openPopup();
    }
  </script>

  <!-- Google Maps loader: keep this LAST; replace YOUR_API_KEY_HERE -->
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAShTpkHyffGlSUWQ9ttWxAVprwj6vUEQo&libraries=places&callback=initMap">
  </script>
</body>
</html>











